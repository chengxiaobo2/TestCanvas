# 技术分享 -- 自定义绘制(结合着Hencoder的自定义绘制的文章以及github的项目讲解)
[github项目地址](https://github.com/chengxiaobo3/TestCanvas)  
[参考资料-hencoder 1-1,1-2](https://hencoder.com/ui-1-1/)  
[参考资料-hencoder二期报班](https://ke.qq.com/course/326937)
## 1. 坐标系（见下图）
<img src="pic/1.png" width=300 height=300> 

## 2. Canvas
* canvas.drawXXX()系列
   * canvas.drawArc()  
      * startAngle：起始的角度，sweepAngle：扫过的角度,userCenter=true|false的情况见下面的图
        ```java
        public void drawArc(@NonNull RectF oval, float startAngle, float sweepAngle, boolean useCenter,
            @NonNull Paint paint) {
        super.drawArc(oval, startAngle, sweepAngle, useCenter, paint);
        }
        ```
        <img src="pic/2.png" width=300 height=150><img src="pic/2_2.png" width=300 height=150>

     * 饼图的例子-上课的例子(见github项目 PieChatView.kt)  
       <img src="pic/3.png" width=150 height=150>  
       思路：
       * 1.给出四个角度（相加等于360），四个不同的颜色。  
       * 2.画四个扇形得到如下结果   
       <img src="pic/3_1.png" width=150 height=150>  
       * 3.第n个偏移(n<4)怎么画呢？画第n个扇形的时候，让坐标系沿着角平分线偏移一下画扇形，画完以后再回到把坐标系移回来，那么问题来了，如何计算坐标系偏移的x和y 呢？     
       <img src="pic/3_2.png" >  

   * canvas.drawPath()  
      * drawPath例子-上课的例子(见github项目 DrawPath.kt)   
       <img src="pic/4.png" width=150 height=150 ><br>
      * path.FillType     
       <img src="pic/5.png" width=400 height=533 >  
    
   * canvas.drawbitmap() (见github项目 DrawBitmap.kt)  
     刚进影视库组时，遇到演员item头像变形（见demo）。  
    <img src="pic/6.png" width=400 height=200 >  

   * canvas.drawText() (第二期讲)
 
* Canvas 的辅助类方法：范围裁切和几何变换（下期讲）
## 3. Paint
 * 常用的方法
   * Paint.setStyle(Style style) 设置线条的模式（空心，实心）
   * Paint.setStrokeWidth(float width) 设置线条宽度
   * Paint.setColor(int color) 设置颜色
   * Paint.setTextSize(float textSize) 设置文字大小
   * Paint.setAntiAlias(boolean aa) 设置抗锯齿开关
* 设置颜色(见扔物线的文档 1-2节)
  *  设置shader 辐射渐变Demo(见github项目 PaintSweepGradient.kt)   
      ```java
      当设置了 Shader 之后，Paint 在绘制图形和文字时就不使用 setColor/ARGB() 设置的颜色了，而是使用 Shader 的方案中的颜色。
      ```
     <img src="pic/7.png" width=150 height=150 >   
   *  工作中canvas画动画的例子(见github项目 IndicatorView.kt和VerticalShapeLoading.kt)   
     <img src="pic/8.gif" width=150 height=150 >  <img src="pic/9.gif" width=150 height=150 >  
  *  画圆形图像的例子-xfermode为上课的例子 (见github项目 CircleBitmapClipPath.kt、CircleBitmapShader.kt和CircleBitmapXfermode.kt)    
     <img src="pic/10.png" width=150 height=150 >  <img src="pic/11.png" width=150 height=150 > <img src="pic/12.png" width=150 height=150 >  
     ```java
     1.通过请教晨星，得知glide库做圆形图像就是用的 xfermode实现的
     2.通过clipPath实现的圆型图片，有锯齿
     3.bitmapShader实现的圆形图片，对bitmap的形状必须是正方形的，如图所示，图片是长方形的，所以底部的图有问题。（并不是不可以实现，可以根据原来的bitmap生成一个方形的bitmap）
     至于为什么用xfermode（混合模式），而非bitmapshader去实现，就是一个疑问了？？？
     ```
* 设置效果
    * pathEffect-上课的例子(见github项目 DashBoard.kt)  
      <img src="pic/13.png" width=150 height=150 > 
## 4.drawText(第二期)
  * 课上例子-对齐的demo
  * 课上例子-breakText的demo
  * 测量文字的宽度的应用(工作中遇到)

## 5. canvas的裁切和canvas的几何变换（第二期）
## 6. 绘制顺序（第二期）
